---
title: "Two Sample Mendelian Randomization on Longevity GWAS"
author: "Christine Le"
date:  "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  slidy_presentation
---
#code folding lookup
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Outline
- Background
- Methods
- Data Description
- Results
- Discussion
- Conclusion


## Background

```{r agingfig}
knitr::include_graphics("images/An_Aging_Nation.png")
```



## Methods

```{r twomrfig, out.width= "50%"}
knitr::include_graphics("images/2MR.png")
```


**Two Sample Mendelian Randomization**

- Exposure: SNPs as a proxy for Exposure from one dataset
- Outcome: outcome from another dataset using SNPs from Exposure to assess the causal relationship between Exposure and Outcome, bypassing confounders that influence the E-O relationship.

**Advantages**

  - readily available data
  
  - simple analyses
  
  - cost-efficient

**Estimate Method - Inverse Variance Weighted**

- simplest method to calculate the MR estimate
- requires all assumptions of the model to be med

## Assumption 1

SNPs are truly associated with Exposure, as seen from independent studies


**Violations**

- low power

  - limit SNP-exposure associations to only those that have been validated in multiple studies
  
- weak gIV

  - solution: limit gIV associated with exposure with high significance in studies from GWAS, and other databases

- LD
  - clump SNPs that are close to each other


- Weighted Median approach
      - allows up to 50% of SNPs to be weak or invalid instruments
      
## Assumption 2 

SNPs are associated with outcome through Exposure only

**Violations**
- Horizontal Pleiotropy

  - when a SNP is related to multiple traits independent of the exposure
  
  - we can use different methods to try and detect the prescence of horizontal pleiotropy
  
  - requires adjusted methods to estimate our association of interest even when present 
  
    - MR Egger : ubiased estimate even in the prescence of horizontal pleiotropy
      

## Assumption 3

SNPs not associated with E-O confounders

- difficult to prove positively to due complex biological pathways and unknown confounders

- can be tested with known confounders of the Exposure-Outcome relationship


## Other Limitations

- developmenal compensation /canalization
   - solution: careful interpretation of results, realizing that both environmental and genetic factors influence an outcome.
   - bias towards null
- collider bias
  - be careful in how we interpret the results of our analysis. Based on current knowledge, could the relationship we see in our study be due to other biases like loss to follow up.
- heterogeneity of effect
   - estimates are not consistent across independent instruments
   - use Cochran's Q statistic(IVW) or Rucker's Q statistic(Egger) to test for this

## Methods for Determining Estimates
Independence of SNPs

- LD clumping : ensuring independence

- Inverse Variance Weighted
  - requires all three assumptions are met
  - simple
  - weights: inverse variance of outcome effects
- Egger
  - InSIDE(Instrument Strength Independent of Direct Effect)
   assumes no correlation between SNP-exposure association and direct efect of SNP-outcome
        
    - suffers from low power
    
    - weak instruments can influence the regression and therefore the estimate
- Median/ Weighted Median
  - allows for up to 50 percent of instruments to be invalid
  - valid instruments : meet all assumptions
  - weighted option: allows for stronger SNPs to contribute more to the estimate. Weights are calculated in the same was as in IVW method.+


## TWoSampleMR Package

**Software- TwoSampleMR Package**

R package developed to utilize 2-sample Mendelian Randomization on GWAS studies with curated databases. 
Allows researchers to more easily perform 2-sample Mendelian Randomization on GWASs to discover and eludicate possible causal relationships between phenotypes and evaluate assumptions of this statistical strategy. 

source: Gibran Hemani, Jie Zheng, Kaitlin H Wade, Charles Laurin, Benjamin Elsworth, Stephen Burgess, Jack Bowden, Ryan Langdon, Vanessa Tan, James Yarmolinsky, Hashem A. $ The MR-Base platform supports systematic causal inference across the human phenome. eLife 2018. doi: https://doi.org/10.7554/eLife.34408 


## Ways to Assess Violations

**Statistical Tests**
Test for Heterogeneity
 - mr_heterogeneity() function
  - will perform a test of heterogeneity on harmonized data
  - if significant and there is the presence of horizontal pleiotropy MR Egger method would result in a better estimate than IVW. 
  If there is no or negligible horizontal pleiotropy, IVW method i

**Graphically**
Scatter plot 
  - can evaluate whether there are outliers in the IV estimates
  
Funnel Plot

**Steps**
1. Find top SNPs associated with each phenotype/exposure, use ld_clump() function  from the ieugwasr package to ensure instruments/SNPs for an exposure are independent.
Note: can use the clump_data() function for non-local clumping. 
2. For each exposure with associated SNPs, find those SNPs in the outcome data, harmonize the merged data to ensure that the SNP association we are seeing is occurring on the same allele and located on the forward strand. (Aligned to human genome build 37)
3. Perform MR
4. Analyze results for violations of assumptions, correct for multiple testing errors
5. Redo 1-3 to account for any violations found in 4

Code : https://github.com/c-le-ds/Longevity/blob/master/Longevity.Rmd

## Data Description - Exposures
Data obtained using IEU GWAS database

**GWAS **
Curated from the NHGRI-EBI GWAS Catalog of significant associations found in different GWAS studies to include only data that has the required information to perform MR analyis. Catalog was further cleaned so that the unit of report is the same.

**Proteins**

Significant associations from GWAS studies on 47 protein levels obtained from whole blood

**Metabolites**

Database of significant associations on 121 metabolites from GWAS studies provided by Peter Wurtz and Mika Ala-Korpela. 

**Genes**

Signficant associations of tissue-specific gene expression  GWASs from the GTEX study. 


**Methylation**

Significant hits from GWASs on DNA methylation levels performed on mothers and children, with five timepoints during the lifecourse (e.g. child - birth, child - childhood, child - adolescence, mother - pregnancy, mother - middle age).


## Data Description - Outcomes

**Pilling**
Results from GWAS study of parental longevity (combined monther's and father's age) on UK Biobank participants. Participants whose parental longevity was in the top 10 percent were compared with all other UK Biobank participants who met the inclusion criteria. 

**Timmers**
GWAS results from 1 million parental lifespans of 500,000 particpants with data on mortalilty risk factors. 

**Deleen**


## Results - Pilling
```{r, echo=FALSE, results='hide',message=FALSE}
library(tidyverse)
library(reactable)
library(VennDiagram)

```
```{r}
readRDS("data/MR/Pilling_multtest_F.rds")%>%
  filter(method == "Inverse variance weighted", pval_BH < 0.05) %>%
  select(-id.exposure, -id.outcome, -outcome, -method)%>%
  arrange(pval)%>%
  reactable(columns = list(
    exposure = colDef(name = "Exposure"),
    exposure_dat = colDef(name = "Exposure Dataset"),
    pval_BH = colDef(name = "BH Adjusted p-value", format = colFormat(digits = 5)),
    b = colDef(format = colFormat(digits = 5)),
    se = colDef(format = colFormat(digits = 5)),
    pval = colDef(format = colFormat(digits = 5))
  ))
  
```



## Results - Timmers


```{r, out.width= "50%"}
readRDS("data/MR/Timmers_multtest_F.rds")%>%
  filter(method == "Inverse variance weighted", pval_BH < 0.05) %>%
  select(-id.exposure, -id.outcome, -outcome, -method)%>%
  arrange(pval)%>%
  reactable(columns = list(
    exposure = colDef(name = "Exposure"),
    exposure_dat = colDef(name = "Exposure Dataset"),
    pval_BH = colDef(name = "BH Adjusted p-value", format = colFormat(digits = 5)),
    b = colDef(format = colFormat(digits = 5)),
    se = colDef(format = colFormat(digits = 5)),
    pval = colDef(format = colFormat(digits = 5))
  ))
  
```



## Results - Deleen Cases 90
```{r}
readRDS("data/MR/Cases90_multtest_F.rds")%>%
  filter(method == "Inverse variance weighted", pval_BH < 0.05) %>%
  select(-id.exposure, -id.outcome, -outcome, -method)%>%
  arrange(pval)%>%
  reactable(columns = list(
    exposure = colDef(name = "Exposure"),
    exposure_dat = colDef(name = "Exposure Dataset"),
    pval_BH = colDef(name = "BH Adjusted p-value", format = colFormat(digits = 5)),
    b = colDef(format = colFormat(digits = 5)),
    se = colDef(format = colFormat(digits = 5)),
    pval = colDef(format = colFormat(digits = 5))
  ))
  
```

## Results - Deleen Cases 99
```{r}
readRDS("data/MR/Cases99_multtest_F.rds")%>%
  filter(method == "Inverse variance weighted", pval_BH < 0.05) %>%
  select(-id.exposure, -id.outcome, -outcome, -method)%>%
  arrange(pval)%>%
  reactable(columns = list(
    exposure = colDef(name = "Exposure"),
    exposure_dat = colDef(name = "Exposure Dataset"),
    pval_BH = colDef(name = "BH Adjusted p-value", format = colFormat(digits = 5)),
    b = colDef(format = colFormat(digits = 5)),
    se = colDef(format = colFormat(digits = 5)),
    pval = colDef(format = colFormat(digits = 5))
  ))
  
```



## Common and Unique Exposures in Each Study - Venn Diagram


```{r, echo=FALSE, results='hide',message=FALSE}


Pilling_dat <- readRDS("data/MR/Pilling_multtest_F.rds")
Timmers_dat <- readRDS("data/MR/Timmers_multtest_F.rds")
Cases90_dat <- readRDS("data/MR/Cases90_multtest_F.rds")
Cases99_dat <- readRDS("data/MR/Cases99_multtest_F.rds")


```


```{r, eval=FALSE}
venn.diagram(
  x = list(
    Pilling_dat %>% 
      filter(method == "Inverse variance weighted", pval_BH <= 0.05, exposure_dat != "methylation") %>% 
      select(exposure) %>% unlist(),
    Timmers_dat %>% 
      filter(method == "Inverse variance weighted", pval_BH <= 0.05) %>% 
      select(exposure) %>% unlist(),
    Cases90_dat %>% 
      filter(method == "Inverse variance weighted", pval_BH <= 0.05) %>% 
      select(exposure) %>% unlist(),
    Cases99_dat %>% 
      filter(method == "Inverse variance weighted", pval_BH <= 0.05) %>% 
      select(exposure) %>% unlist()
  ),
  category.names = c("Pilling", "Timmers", "Deleen 90th", "Deleen 99th"),
  filename = "images/FourOutcomesVenn.png",
  output = TRUE,
          imagetype="png" ,
          height = 900 , 
          width = 1200 , 
          resolution = 300,
          compression = "lzw",
          lwd = 1,
          col=c("#440154ff", '#21908dff', '#fde725ff', '#ff3374'),
          fill = c(alpha("#440154ff",0.3), alpha('#21908dff',0.3), alpha('#fde725ff',0.3), alpha('#ff3374', 0.3))

  
)
```
```{r, out.width = "50%"}
knitr::include_graphics("images/FourOutcomesVenn.png")
```
For exposures with adjusted p-values less than or equal to 0.05
- no common exposures among Pilling, cases90 & cases 99 
- no common exposures among pilling & cases 99
- no common exposures among pilling , timmers and cases 99

## Results - Table


```{r, out.width="50%"}

#Create a table containing adjusted p-values and informationon exposure dataset, and outcome dataset sources
PillingA <- Pilling_dat %>% 
  filter(method == "Inverse variance weighted", exposure_dat != "methylation") %>%
  mutate(Pilling = "Yes") %>%
  rename(Exposure.Dataset.Pilling = exposure_dat, Adjusted.p.Pilling = pval_BH, 
         b.pilling = b, se.pilling = se, nsnp.pilling = nsnp, pval.pilling = pval ) %>% 
  select(-id.exposure, -id.outcome, -outcome, -method) 
TimmersA <- Timmers_dat %>% 
  filter(method == "Inverse variance weighted") %>%
  mutate(Timmers = "Yes") %>%
  rename(Exposure.Dataset.Timmers = exposure_dat, Adjusted.p.Timmers = pval_BH, 
         b.timmers = b, se.timmers = se, nsnp.timmers = nsnp, pval.timmers = pval) %>% 
  select(-id.exposure, -id.outcome, -outcome, -method) 
Cases90A <- Cases90_dat %>%
  filter(method == "Inverse variance weighted") %>%
  mutate(Cases90 = "Yes") %>%
  rename(Exposure.Dataset.Cases90 = exposure_dat, Adjusted.p.Cases90 = pval_BH, 
         b.90 = b, se.90 = se, nsnp.90 = nsnp, pval.90 = pval) %>% 
  select(-id.exposure, -id.outcome, -outcome, -method)
Cases99A <- Cases99_dat %>%
  filter(method == "Inverse variance weighted") %>%
  mutate(Cases99 = "Yes") %>%
  rename(Exposure.Dataset.Cases99 = exposure_dat, Adjusted.p.Cases99 = pval_BH,
         b.99 = b, se.99 = se, nsnp.99 = nsnp, pval.99 = pval) %>% 
  select(-id.exposure, -id.outcome, -outcome, -method)

dat_all <- merge(TimmersA, PillingA, by = "exposure", all = TRUE)
dat_all <- merge(dat_all, Cases90A, by = "exposure", all = TRUE)
dat_all <- merge(dat_all, Cases99A, by = "exposure", all = TRUE)


#replace NAs in Dataset columns with "NO"

dat_all$Pilling <- ifelse(is.na(dat_all$Pilling), "NO", "YES")-
dat_all$Timmers <- ifelse(is.na(dat_all$Timmers), "NO", "YES")
dat_all$Cases90 <- ifelse(is.na(dat_all$Cases90), "NO", "YES")
dat_all$Cases99 <- ifelse(is.na(dat_all$Cases99), "NO", "YES")



#Make one Exposure Dataset column

dat_all$Exposure.Dataset <- ifelse(dat_all$Pilling == "YES", dat_all$Exposure.Dataset.Pilling,
                               ifelse(dat_all$Timmers == "YES", dat_all$Exposure.Dataset.Timmers,
                                      ifelse(dat_all$Cases90 == "YES", dat_all$Exposure.Dataset.Cases90,
                                             ifelse(dat_all$Cases99 == "YES", dat_all$Exposure.Dataset.Cases99, NA)
                                             )
                                      )
                               )
#remove extra exposure dataset columns
dat <- dat_all
dat <- dat %>%
 select(exposure, Pilling, Timmers, Cases90, Cases99, Adjusted.p.Pilling, Adjusted.p.Timmers, Adjusted.p.Cases90, Adjusted.p.Cases99, Exposure.Dataset)


#save results for future use

saveRDS(dat, "results/results_201908.rds")
saveRDS(dat_all, "results/full_results_201908.rds")
```
Table 1. Exposures among Four Outcomes who are significant(adjusted p-value $\leq$ 0.05) using the Inverse Variance Weighted Method
```{r, out.width="50%"}

#create a filterable table
reactable(filter(dat, Adjusted.p.Timmers <= 0.05 | Adjusted.p.Cases90 <= 0.05 | Adjusted.p.Cases99 <= 0.05 | Adjusted.p.Pilling <=0.05| is.na(Adjusted.p.Timmers)|is.na(Adjusted.p.Cases90) |is.na(Adjusted.p.Cases99)| is.na(Adjusted.p.Pilling)), filterable = TRUE, paginationType = "jump", showSortable = TRUE, bordered = TRUE,
          columns = list( 
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Timmers = colDef(name = "Adjusted p-value (Timmers)", 
                                        align = "center", headerStyle = list(background = "#f7f7f8"),
                                        filterable = FALSE, format = colFormat(digits = 5)),         
            Adjusted.p.Pilling = colDef(name = "Adjusted p-value (Pilling)", 
                                        align = "center",headerStyle = list(background = "#f7f7f8"),
                                        filterable = FALSE, format = colFormat(digits = 5)),
            Adjusted.p.Cases90 = colDef(name = "Adjusted p-value (Cases90)", 
                                   align = "center",headerStyle = list(background = "#f7f7f8"),
                                   filterable = FALSE, format = colFormat(digits = 5)),
            Adjusted.p.Cases99 = colDef(name = "Adjusted p-value (Cases99)", 
                                   align = "center",headerStyle = list(background = "#f7f7f8"),
                                   filterable = FALSE, format = colFormat(digits = 5)),
            Exposure.Dataset = colDef(name = "Exposure Dataset", 
                                              align = "center",headerStyle = list(background = "#f7f7f8")),
            Pilling = colDef(name = "Pilling", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }),
            Timmers = colDef(cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }),
            Cases90 = colDef(name = "90th Percentile", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }),
            Cases99 = colDef(name = "99th Percentile", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            })
          ))
```






## Common Exposures - All four datasets

Table 2. Common Exposures Among All Four Outcomes
```{r}

dat_all %>% filter(Pilling == "YES" & Timmers == "YES" & Cases90 == "YES" & Cases99 == "YES") %>% 
  select(exposure,  b.pilling, se.pilling, pval.pilling, Adjusted.p.Pilling,  b.timmers, se.timmers, pval.timmers, Adjusted.p.Timmers, b.90, se.90, pval.90, Adjusted.p.Cases90, b.99, se.99, pval.99, Adjusted.p.Cases99, Exposure.Dataset) %>%
  # select(exposure, nsnp.pilling, b.pilling, se.pilling, pval.pilling, Adjusted.p.Pilling, nsnp.timmers, b.timmers, se.timmers, pval.timmers, Adjusted.p.Timmers, nsnp.90, b.90, se.90, pval.90, Adjusted.p.Cases90, nsnp.99, b.99, se.99, pval.99, Adjusted.p.Cases99, Exposure.Dataset) %>%
  
  reactable(filterable = TRUE, bordered = TRUE, columns = list(
    
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Cases90 = colDef(name = "90th Percentile", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            # nsnp.90 = colDef(name = "90th Percentile", align = "center",
            #                       headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.90 = colDef(name = "90th Percentile", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.90 = colDef(name = "90th Percentile", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
             pval.90 = colDef(name = "90th Percentile", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Adjusted.p.Cases99 = colDef(name = "99th Percentile", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            # nsnp.99 = colDef(name = "99th Percentile", align = "center",
            #                       headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.99 = colDef(name = "99th Percentile", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.99 = colDef(name = "99th Percentile", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
             pval.99 = colDef(name = "99th Percentile", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Adjusted.p.Timmers = colDef(name = "Timmers", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            # nsnp.timmers = colDef(name = "Timmers", align = "center",
            #                       headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.timmers = colDef(name = "Timmers", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.timmers = colDef(name = "Timmers", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
             pval.timmers =colDef(name = "Timmers", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Adjusted.p.Pilling = colDef(name = "Pilling", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            # nsnp.pilling = colDef(name = "Pilling", align = "center",
            #                       headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.pilling = colDef(name = "Pilling", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
             pval.pilling =colDef(name = "Pilling", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            
            se.pilling = colDef(name = "Pilling", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5))
  ),
  
            
          
            columnGroups = list(
              # colGroup(name = "nsnp", columns = c("nsnp.timmers", "nsnp.pilling", "nsnp.90", "nsnp.99")),
              colGroup(name = "Beta", columns = c("b.pilling", "b.timmers", "b.90", "b.99")),
              colGroup(name = "SE", columns = c("se.pilling", "se.timmers", "se.90", "se.99")),
              colGroup(name = "p-value", columns = c("pval.pilling", "pval.timmers", "pval.90", "pval.99")),
              colGroup(name = "Adjusted BH p-value", columns = c("Adjusted.p.Pilling", "Adjusted.p.Timmers", "Adjusted.p.Cases90", "Adjusted.p.Cases99"))
            ))
```

## Shared Exposures Deleen 90th Percentile

Table 3. Significant Exposures (adjusted p-value $\leq$ 0.05) found in Deleen's 90th percentile shared among all four outcomes
```{r}

table3 <- dat_all %>% filter(Pilling == "YES" & Timmers == "YES" & Cases99 == "YES" & Cases90 ==  "YES") %>%
  filter(Adjusted.p.Cases90 <= 0.05 & !is.na(Adjusted.p.Timmers) & !is.na(Adjusted.p.Cases90)&!is.na(Adjusted.p.Cases99)&!is.na(Adjusted.p.Pilling)) %>%
  select(exposure,  b.pilling, se.pilling, pval.pilling, Adjusted.p.Pilling,  b.timmers, se.timmers, pval.timmers, Adjusted.p.Timmers, b.90, se.90, pval.90, Adjusted.p.Cases90, b.99, se.99, pval.99, Adjusted.p.Cases99, Exposure.Dataset)
reactable(table3, filterable = TRUE, bordered = TRUE,
          columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Cases90 = colDef(name = "90th Percentile", 
                                        align = "center",
                                        headerStyle = list(background = "#f7f7f8"), 
                                        format = colFormat(digits = 5)),
            Exposure.Dataset = colDef(name = "Exposure Dataset", 
                                      align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            # nsnp.90 = colDef(name = "90th Percentile", align = "center",
            #                       headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.90 = colDef(name = "90th Percentile", align = "center",
                               headerStyle = list(background = "#f7f7f8"),
                          format = colFormat(digits = 5)),
            se.90 = colDef(name = "90th Percentile", align = "center",
                                headerStyle = list(background = "#f7f7f8"),
                           format = colFormat(digits = 5)),
             pval.90 = colDef(name = "90th Percentile", align = "center",
                                  headerStyle = list(background = "#f7f7f8"),
                              format = colFormat(digits = 5)),
            Adjusted.p.Cases99 = colDef(name = "99th Percentile", 
                                        align = "center",
                                        headerStyle = list(background = "#f7f7f8"), 
                                        format = colFormat(digits = 5)),
            # nsnp.99 = colDef(name = "99th Percentile", align = "center",
            #                       headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.99 = colDef(name = "99th Percentile", align = "center",
                               headerStyle = list(background = "#f7f7f8"),
                          format = colFormat(digits = 5)),
            se.99 = colDef(name = "99th Percentile", align = "center",
                                headerStyle = list(background = "#f7f7f8"),
                           format = colFormat(digits = 5)),
             pval.99 = colDef(name = "99th Percentile", align = "center",
                                  headerStyle = list(background = "#f7f7f8"),
                              format = colFormat(digits = 5)),
            Adjusted.p.Timmers = colDef(name = "Timmers", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), 
                                        format = colFormat(digits = 5)),
            # nsnp.timmers = colDef(name = "Timmers", align = "center",
            #                       headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.timmers = colDef(name = "Timmers", align = "center",
                               headerStyle = list(background = "#f7f7f8"),
                               format = colFormat(digits = 5)),
            se.timmers = colDef(name = "Timmers", align = "center",
                                headerStyle = list(background = "#f7f7f8"),
                                format = colFormat(digits = 5)),
             pval.timmers =colDef(name = "Timmers", align = "center",
                                  headerStyle = list(background = "#f7f7f8"),
                                  format = colFormat(digits = 5)),
            Adjusted.p.Pilling = colDef(name = "Pilling", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), 
                                        format = colFormat(digits = 5)),
            # nsnp.pilling = colDef(name = "Pilling", align = "center",
            #                       headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.pilling = colDef(name = "Pilling", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
             pval.pilling =colDef(name = "Pilling", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            
            se.pilling = colDef(name = "Pilling", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5))
  ),
  
            
          
            columnGroups = list(
              # colGroup(name = "nsnp", columns = c("nsnp.timmers", "nsnp.pilling", "nsnp.90", "nsnp.99")),
              colGroup(name = "Beta", columns = c("b.pilling", "b.timmers", "b.90", "b.99")),
              colGroup(name = "SE", columns = c("se.pilling", "se.timmers", "se.90", "se.99")),
              colGroup(name = "p-value", columns = c("pval.pilling", "pval.timmers", "pval.90", "pval.99")),
              colGroup(name = "Adjusted BH p-value", columns = c("Adjusted.p.Pilling", "Adjusted.p.Timmers", "Adjusted.p.Cases90", "Adjusted.p.Cases99"))
            ),
  rowStyle = function(index) {
    if (table3[index, "Adjusted.p.Timmers"] <= 0.05)
      list(fontWeight = "bold")
    else if(table3[index, "Adjusted.p.Pilling"] <= 0.05)
      list(fontWeight = "bold")
    else if(table3[index, "Adjusted.p.Cases90"] <= 0.05)
      list(fontWeight = "bold")
    else if(table3[index, "Adjusted.p.Cases99"] <= 0.05)
      list(fontWeight = "bold")

  }
  
)

```

## Common Exposures Among Deleen 99th Percentile Longevity Outcomes

Table 4. Significant Exposures for 99th Percentile of Longevity (adjusted p-value $\leq$ 0.05) shared among all four outcomes

```{r}

dat_all %>% filter(Cases90 == "YES" & Cases99 == "YES") %>%
  filter( Adjusted.p.Cases90 <= 0.05 | Adjusted.p.Cases99 <= 0.05 |is.na(Adjusted.p.Cases90) |is.na(Adjusted.p.Cases99)) %>%
  select(exposure, nsnp.90, b.90, se.90, pval.90, Adjusted.p.Cases90, nsnp.99, b.99, se.99, pval.99, Adjusted.p.Cases99, Exposure.Dataset) %>%
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Cases90 = colDef(name = "90th Percentile", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            nsnp.90 = colDef(name = "90th Percentile", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.90 = colDef(name = "90th Percentile", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.90 = colDef(name = "90th Percentile", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.90 = colDef(name = "90th Percentile", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Adjusted.p.Cases99 = colDef(name = "99th Percentile", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            nsnp.99 = colDef(name = "99th Percentile", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.99 = colDef(name = "99th Percentile", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.99 = colDef(name = "99th Percentile", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.99 = colDef(name = "99th Percentile", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5))
            
            
            ),
            columnGroups = list(
              colGroup(name = "nsnp", columns = c("nsnp.90", "nsnp.99")),
              colGroup(name = "Beta", columns = c("b.90", "b.99")),
              colGroup(name = "SE", columns = c("se.90", "se.99")),
              colGroup(name = "p-value", columns = c("pval.90", "pval.99")),
              colGroup(name = "Adjusted BH p-value", columns = c("Adjusted.p.Cases90", "Adjusted.p.Cases99"))
            ))
```

## Common Exposures among Longevity studies that looked at 90th Percentile 

Table 5. Significant Exposures (adjusted p-value $\leq$ 0.05) looking at Longevity in the 90th percentile
```{r}

dat_all %>% filter(Pilling == "YES" & Timmers == "YES" & Cases90 == "YES" ) %>%
  filter(Adjusted.p.Timmers <= 0.05 | Adjusted.p.Cases90 <= 0.05  | Adjusted.p.Pilling <=0.05| is.na(Adjusted.p.Timmers)|is.na(Adjusted.p.Cases90) | is.na(Adjusted.p.Pilling))%>%
  select(exposure, nsnp.pilling, b.pilling, se.pilling, pval.pilling, Adjusted.p.Pilling, nsnp.timmers, b.timmers, se.timmers, pval.timmers, Adjusted.p.Timmers, nsnp.90, b.90, se.90, pval.90, Adjusted.p.Cases90, Exposure.Dataset) %>%
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Cases90 = colDef(name = "90th Percentile", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            nsnp.90 = colDef(name = "90th Percentile", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.90 = colDef(name = "90th Percentile", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.90 = colDef(name = "90th Percentile", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.90 = colDef(name = "90th Percentile", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Adjusted.p.Timmers = colDef(name = "Timmers", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            nsnp.timmers = colDef(name = "Timmers", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.timmers = colDef(name = "Timmers", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.timmers = colDef(name = "Timmers", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.timmers =colDef(name = "Timmers", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Adjusted.p.Pilling = colDef(name = "Pilling", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            nsnp.pilling = colDef(name = "Pilling", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.pilling = colDef(name = "Pilling", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.pilling = colDef(name = "Pilling", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.pilling =colDef(name = "Pilling", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5))
            
            ),
            columnGroups = list(
              colGroup(name = "nsnp", columns = c("nsnp.timmers", "nsnp.pilling", "nsnp.90")),
              colGroup(name = "Beta", columns = c("b.pilling", "b.timmers", "b.90")),
              colGroup(name = "SE", columns = c("se.pilling", "se.timmers", "se.90")),
              colGroup(name = "p-value", columns = c("pval.pilling", "pval.timmers", "pval.90")),
              colGroup(name = "Adjusted BH p-value", columns = c("Adjusted.p.Pilling", "Adjusted.p.Timmers", "Adjusted.p.Cases90"))
            ))
```


## Pilling - Unique Exposures
Table 7.Significant Exposures (adjusted p-value $\leq$ 0.05) unique only to the Timmers dataset

```{r}
dat_all %>% filter(Pilling == "YES" & Timmers == "NO" & Cases90 == "NO" & Cases99 == "NO") %>%
  filter( Adjusted.p.Pilling <=0.05|  is.na(Adjusted.p.Pilling)) %>%
  select(exposure, nsnp.pilling, b.pilling, se.pilling, pval.pilling, Adjusted.p.Pilling, Exposure.Dataset.Pilling) %>%
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Pilling = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset.Pilling = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            nsnp.pilling = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.pilling = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.pilling = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.pilling =colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)) 
            
            ))
```


Table 6.Significant Exposures (adjusted p-value $\leq$ 0.05) unique only to the Pilling dataset

## Timmers - Unique Exposures
```{r}
dat_all %>% filter(Pilling == "NO" & Timmers == "YES" & Cases90 == "NO" & Cases99 == "NO") %>%
  select(exposure, nsnp.timmers, b.timmers, se.timmers, pval.timmers, Adjusted.p.Timmers, Exposure.Dataset.Timmers) %>%
  filter(Adjusted.p.Timmers <= 0.05 | is.na(Adjusted.p.Timmers)) %>%
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Timmers = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset.Timmers = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            nsnp.timmers = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.timmers = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.timmers = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.timmers =colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)) 
            
            ))
```


## Deleen Cases 90 - Unique Exposures

Table 8.Significant Exposures (adjusted p-value $\leq$ 0.05) unique only to Deleen's 90th Percentile 

```{r}
dat_all %>% filter(Pilling == "NO" & Timmers == "NO" & Cases90 == "YES" & Cases99 == "NO") %>%
  select(exposure, nsnp.90, b.90, se.90, pval.90, Adjusted.p.Cases90, Exposure.Dataset.Cases90) %>%
  filter(Adjusted.p.Cases90 <= 0.05 |is.na(Adjusted.p.Cases90)) %>%
  
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Cases90 = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset.Cases90 = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            nsnp.90 = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.90 = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.90 = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.90 = colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)) 
            
            ))
```




## Deleen 99th Percentile - Unique Exposures

Table 9.Significant Exposures (adjusted p-value $\leq$ 0.05) unique only to Deleen's 99th Percentile

```{r}
dat_all %>% filter(Pilling == "NO" & Timmers == "NO" & Cases90 == "NO" & Cases99 == "YES") %>%
  filter(Adjusted.p.Cases99 <= 0.05 |is.na(Adjusted.p.Cases99))
  select(exposure, nsnp.99, b.99, se.99, pval.99, Adjusted.p.Cases99, Exposure.Dataset.Cases99) %>%
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Cases99 = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset.Cases99 = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            nsnp.99 = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.99 = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.99 = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.99 = colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)) 
            
            ))
```


## Comparing Studies - Deleen 90th Percentile versus 99th Percentile

Table 10. Significant Exposures (adjusted p-value $\leq$ 0.05) Among Deleen Datasets

```{r}
dat_all %>% filter(Cases90 == "YES" | Cases99 == "YES") %>%
  select(exposure, Cases90, Cases99, nsnp.90, b.90, se.90, pval.90, Adjusted.p.Cases90, nsnp.99, b.99, se.99, pval.99, Adjusted.p.Cases99, Exposure.Dataset) %>%
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Cases99 = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            
            nsnp.99 = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.99 = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.99 = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.99 = colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Adjusted.p.Cases90 = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            nsnp.90 = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.90 = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.90 = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.90 = colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            Cases90 = colDef(name = "90th Percentile", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }, filterable = TRUE),
            Cases99 = colDef(name = "99th Percentile", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }, filterable = TRUE)
            
            ),
            
            columnGroups = list(
              colGroup(name = "90th Percentile", columns = c("b.90", "se.90", "nsnp.90", "pval.90", "Adjusted.p.Cases90")),
              colGroup(name = "99th Percentile", columns = c("b.99", "se.99", "nsnp.99", "pval.99", "Adjusted.p.Cases99"))
            )
            
             
            
            
            )
```

## Comparison - Deleen 90th Percentile versus Pilling 90th Percentile Longevity

Table 11. Significant Exposures (adjusted p-value $\leq$ 0.05) 

```{r}
dat_all %>% filter(Cases90 == "YES" | Pilling == "YES") %>%
  select(exposure, Cases90, Pilling, nsnp.90, b.90, se.90, pval.90, Adjusted.p.Cases90, nsnp.pilling, b.pilling, se.pilling, pval.pilling, Adjusted.p.Pilling, Exposure.Dataset) %>%
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Pilling = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            nsnp.pilling = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.pilling = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.pilling = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.pilling =colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Adjusted.p.Cases90 = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            nsnp.90 = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.90 = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.90 = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.90 = colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            Cases90 = colDef(name = "Deleen et al.", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }, filterable = TRUE),
            Pilling = colDef(name = "Pilling et al.", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }, filterable = TRUE)
            
            ),
            
            columnGroups = list(
              colGroup(name = "Deleen et al.", columns = c("b.90", "se.90", "nsnp.90", "pval.90", "Adjusted.p.Cases90")),
              colGroup(name = "Pilling et al.", columns = c("b.pilling", "se.pilling", "nsnp.pilling", "pval.pilling", "Adjusted.p.Pilling"))
            )
            
             
            
            
            )
```



## Comparison - Deleen 90th Percentile versus Pilling 90th Percentile Longevity
Table 12. 
```{r}
dat_all %>% filter(Cases90 == "YES" | Timmers == "YES") %>%
  select(exposure, Cases90, Timmers, nsnp.90, b.90, se.90, pval.90, Adjusted.p.Cases90,  nsnp.timmers, b.timmers, se.timmers, pval.timmers, Adjusted.p.Timmers, Exposure.Dataset) %>%
  reactable(columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Timmers = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            nsnp.timmers = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.timmers = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.timmers = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.timmers =colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)) ,
            Adjusted.p.Cases90 = colDef(name = "Adjusted p-value", align = "center",
                                        headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            nsnp.90 = colDef(name = "nsnp", align = "center",
                                  headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            b.90 = colDef(name = "Beta", align = "center",
                               headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            se.90 = colDef(name = "SE", align = "center",
                                headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            pval.90 = colDef(name = "p-value", align = "center",
                                 headerStyle = list(background = "#f7f7f8"), format = colFormat(digits = 5)),
            Exposure.Dataset = colDef(name = "Exposure Dataset", align = "center",
                                      headerStyle = list(background = "#f7f7f8")),
            Cases90 = colDef(name = "Deleen et al.", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }, filterable = TRUE),
            Timmers = colDef(name = "Timmers et al.", cell = function(value){
              if(value == "NO") "\u2718" else "\u2713"
            }, filterable = TRUE)
            
            ),
            
            columnGroups = list(
              colGroup(name = "Deleen et al.", columns = c("b.90", "se.90", "nsnp.90", "pval.90", "Adjusted.p.Cases90")),
              colGroup(name = "Timmers et al.", columns = c("b.timmers", "se.timmers", "nsnp.timmers", "pval.timmers", "Adjusted.p.Timmers"))
            )
            
             
            
            
            )
```


Table 13 . Exposures among Four Outcomes who are significant(adjusted p-value $\leq$ 0.05) using the Inverse Variance Weighted Method with unadjusted and adjusted p-values
```{r}
#filter on OR 
#create a filterable table
dat_all %>% select(exposure, Adjusted.p.Timmers,Adjusted.p.Pilling, Adjusted.p.Cases90, Adjusted.p.Cases99, pval.timmers, pval.pilling, pval.90, pval.99)%>%
  reactable(filterable = TRUE, paginationType = "jump", showSortable = TRUE,
          columns = list(
            exposure = colDef(name = "Exposure"),
            Adjusted.p.Timmers = colDef(name = "Adjusted p-value (Timmers)", 
                                        align = "center", headerStyle = list(background = "#f7f7f8"),
                                        filterable = FALSE, format = colFormat(digits = 5)),         
            Adjusted.p.Pilling = colDef(name = "Adjusted p-value (Pilling)", 
                                        align = "center",headerStyle = list(background = "#f7f7f8"),
                                        filterable = FALSE, format = colFormat(digits = 5)),
            Adjusted.p.Cases90 = colDef(name = "Adjusted p-value (Cases90)", 
                                   align = "center",headerStyle = list(background = "#f7f7f8"),
                                   filterable = FALSE, format = colFormat(digits = 5)),
            Adjusted.p.Cases99 = colDef(name = "Adjusted p-value (Cases99)", 
                                   align = "center",headerStyle = list(background = "#f7f7f8"),
                                   filterable = FALSE, format = colFormat(digits = 5)),
            pval.timmers = colDef(name = "p-value (Timmers)", 
                                   align = "center",headerStyle = list(background = "#f7f7f8"),
                                   filterable = FALSE, format = colFormat(digits = 5)),
            pval.pilling = colDef(name = "p-value (Pilling)", 
                                        align = "center",headerStyle = list(background = "#f7f7f8"),
                                        filterable = FALSE, format = colFormat(digits = 5)),
            pval.90 = colDef(name = "p-value (Cases90)", 
                                   align = "center",headerStyle = list(background = "#f7f7f8"),
                                   filterable = FALSE, format = colFormat(digits = 5)),
            pval.99 = colDef(name = "p-value (Cases99)", 
                                   align = "center",headerStyle = list(background = "#f7f7f8"),
                                   filterable = FALSE, format = colFormat(digits = 5))
            
          ))
```
            
## Conclusion



## Limitations and Next Steps


#Citations 
Stephen Burgess, Simon G Thompson, CRP CHD Genetics Collaboration, Avoiding bias from weak instruments in Mendelian randomization studies, International Journal of Epidemiology, Volume 40, Issue 3, June 2011, Pages 755–764, https://doi.org/10.1093/ije/dyr036


Davies NM, Holmes MV, Davey Smith G. Reading Mendelian randomisation studies: a guide, glossary, and checklist for clinicians. BMJ. 2018;362:k601. Published 2018 Jul 12. doi:10.1136/bmj.k601

Zheng, J., Baird, D., Borges, M. et al. Recent Developments in Mendelian Randomization Studies. Curr Epidemiol Rep 4, 330–345 (2017). https://doi.org/10.1007/s40471-017-0128-6
